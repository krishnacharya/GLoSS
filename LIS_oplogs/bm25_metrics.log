nohup: ignoring input
Running job for dataset: beauty, data family: amazon, k: 5, split: test, bm25_index_name: beauty_index
WARNING:2025-05-22 12:51:13,453:jax._src.xla_bridge:967: An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
Split strings:   0%|          | 0/12094 [00:00<?, ?it/s]                                                        Loaded BM25 retriever from /home/kacharya33/nanoGenRec/bm25_indexes/beauty_index

Qrels (test):
------------------------------
Split strings:   0%|          | 0/22363 [00:00<?, ?it/s]Split strings:  90%|████████▉ | 20033/22363 [00:00<00:00, 200313.00it/s]                                                                        BM25S Retrieve:   0%|          | 0/22363 [00:00<?, ?it/s]BM25S Retrieve:   2%|▏         | 548/22363 [00:00<00:03, 5474.37it/s]BM25S Retrieve:   5%|▌         | 1166/22363 [00:00<00:03, 5886.54it/s]BM25S Retrieve:   8%|▊         | 1793/22363 [00:00<00:03, 6060.12it/s]BM25S Retrieve:  11%|█         | 2415/22363 [00:00<00:03, 6122.39it/s]BM25S Retrieve:  14%|█▎        | 3041/22363 [00:00<00:03, 6170.46it/s]BM25S Retrieve:  16%|█▋        | 3667/22363 [00:00<00:03, 6200.02it/s]BM25S Retrieve:  19%|█▉        | 4291/22363 [00:00<00:02, 6210.88it/s]BM25S Retrieve:  22%|██▏       | 4913/22363 [00:00<00:02, 6207.65it/s]BM25S Retrieve:  25%|██▍       | 5534/22363 [00:00<00:02, 6193.93it/s]BM25S Retrieve:  28%|██▊       | 6154/22363 [00:01<00:02, 6172.88it/s]BM25S Retrieve:  30%|███       | 6772/22363 [00:01<00:02, 6154.34it/s]BM25S Retrieve:  33%|███▎      | 7388/22363 [00:01<00:02, 6133.13it/s]BM25S Retrieve:  36%|███▌      | 8002/22363 [00:01<00:02, 6133.35it/s]BM25S Retrieve:  39%|███▊      | 8616/22363 [00:01<00:02, 6121.09it/s]BM25S Retrieve:  41%|████▏     | 9229/22363 [00:01<00:02, 6119.94it/s]BM25S Retrieve:  44%|████▍     | 9843/22363 [00:01<00:02, 6125.53it/s]BM25S Retrieve:  47%|████▋     | 10458/22363 [00:01<00:01, 6124.87it/s]BM25S Retrieve:  50%|████▉     | 11076/22363 [00:01<00:01, 6139.86it/s]BM25S Retrieve:  52%|█████▏    | 11690/22363 [00:01<00:01, 6120.46it/s]BM25S Retrieve:  55%|█████▌    | 12305/22363 [00:02<00:01, 6127.27it/s]BM25S Retrieve:  58%|█████▊    | 12918/22363 [00:02<00:01, 6116.33it/s]BM25S Retrieve:  61%|██████    | 13534/22363 [00:02<00:01, 6127.65it/s]BM25S Retrieve:  63%|██████▎   | 14147/22363 [00:02<00:01, 6117.15it/s]BM25S Retrieve:  66%|██████▌   | 14763/22363 [00:02<00:01, 6126.76it/s]BM25S Retrieve:  69%|██████▉   | 15376/22363 [00:02<00:01, 4168.19it/s]BM25S Retrieve:  72%|███████▏  | 15994/22363 [00:02<00:01, 4620.81it/s]BM25S Retrieve:  74%|███████▍  | 16607/22363 [00:02<00:01, 4987.90it/s]BM25S Retrieve:  77%|███████▋  | 17227/22363 [00:02<00:00, 5299.71it/s]BM25S Retrieve:  80%|███████▉  | 17836/22363 [00:03<00:00, 5512.23it/s]BM25S Retrieve:  83%|████████▎ | 18451/22363 [00:03<00:00, 5687.78it/s]BM25S Retrieve:  85%|████████▌ | 19062/22363 [00:03<00:00, 5804.67it/s]BM25S Retrieve:  88%|████████▊ | 19677/22363 [00:03<00:00, 5903.11it/s]BM25S Retrieve:  91%|█████████ | 20291/22363 [00:03<00:00, 5969.70it/s]BM25S Retrieve:  93%|█████████▎| 20909/22363 [00:03<00:00, 6029.77it/s]BM25S Retrieve:  96%|█████████▌| 21521/22363 [00:03<00:00, 6054.38it/s]BM25S Retrieve:  99%|█████████▉| 22141/22363 [00:03<00:00, 6095.58it/s]                                                                       
Evaluating Text-Based Last Similar Recommendations:
------------------------------
{'recall@5': 0.04333050127442651, 'ndcg@5': 0.023179244762936268, 'mrr': 0.016472894215147044}
------------------------------
Per-user metrics saved to /home/kacharya33/nanoGenRec/peruser_metrics/LIS/bm25/beauty.jsonl

--- Evaluation Summary ---
Dataset: beauty
BM25 index file: /home/kacharya33/nanoGenRec/bm25_indexes/beauty_index
Metrics: {'recall@5': 0.04333050127442651, 'ndcg@5': 0.023179244762936268, 'mrr': 0.016472894215147044}
Running job for dataset: toys, data family: amazon, k: 5, split: test, bm25_index_name: toys_index
WARNING:2025-05-22 12:55:58,868:jax._src.xla_bridge:967: An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
Split strings:   0%|          | 0/11865 [00:00<?, ?it/s]                                                        Loaded BM25 retriever from /home/kacharya33/nanoGenRec/bm25_indexes/toys_index

Qrels (test):
------------------------------
Split strings:   0%|          | 0/19395 [00:00<?, ?it/s]                                                        BM25S Retrieve:   0%|          | 0/19395 [00:00<?, ?it/s]BM25S Retrieve:   3%|▎         | 601/19395 [00:00<00:03, 6005.54it/s]BM25S Retrieve:   7%|▋         | 1286/19395 [00:00<00:02, 6497.70it/s]BM25S Retrieve:  10%|█         | 1980/19395 [00:00<00:02, 6695.53it/s]BM25S Retrieve:  14%|█▍        | 2670/19395 [00:00<00:02, 6775.29it/s]BM25S Retrieve:  17%|█▋        | 3367/19395 [00:00<00:02, 6842.93it/s]BM25S Retrieve:  21%|██        | 4052/19395 [00:00<00:02, 6817.83it/s]BM25S Retrieve:  24%|██▍       | 4734/19395 [00:00<00:02, 6815.84it/s]BM25S Retrieve:  28%|██▊       | 5416/19395 [00:00<00:02, 6812.59it/s]BM25S Retrieve:  31%|███▏      | 6098/19395 [00:00<00:01, 6806.05it/s]BM25S Retrieve:  35%|███▍      | 6779/19395 [00:01<00:01, 6794.99it/s]BM25S Retrieve:  38%|███▊      | 7459/19395 [00:01<00:01, 6789.09it/s]BM25S Retrieve:  42%|████▏     | 8139/19395 [00:01<00:01, 6792.27it/s]BM25S Retrieve:  45%|████▌     | 8819/19395 [00:01<00:01, 6778.63it/s]BM25S Retrieve:  49%|████▉     | 9497/19395 [00:01<00:01, 6777.07it/s]BM25S Retrieve:  52%|█████▏    | 10178/19395 [00:01<00:01, 6784.56it/s]BM25S Retrieve:  56%|█████▌    | 10858/19395 [00:01<00:01, 6786.42it/s]BM25S Retrieve:  60%|█████▉    | 11542/19395 [00:01<00:01, 6799.92it/s]BM25S Retrieve:  63%|██████▎   | 12222/19395 [00:01<00:01, 6765.12it/s]BM25S Retrieve:  67%|██████▋   | 12899/19395 [00:01<00:00, 6761.51it/s]BM25S Retrieve:  70%|██████▉   | 13576/19395 [00:02<00:00, 6742.84it/s]BM25S Retrieve:  73%|███████▎  | 14251/19395 [00:02<00:00, 6744.75it/s]BM25S Retrieve:  77%|███████▋  | 14926/19395 [00:02<00:00, 6740.87it/s]BM25S Retrieve:  80%|████████  | 15606/19395 [00:02<00:00, 6758.12it/s]BM25S Retrieve:  84%|████████▍ | 16286/19395 [00:02<00:00, 6769.91it/s]BM25S Retrieve:  87%|████████▋ | 16964/19395 [00:02<00:00, 6763.62it/s]BM25S Retrieve:  91%|█████████ | 17645/19395 [00:02<00:00, 6775.00it/s]BM25S Retrieve:  94%|█████████▍| 18323/19395 [00:02<00:00, 4598.61it/s]BM25S Retrieve:  98%|█████████▊| 18992/19395 [00:02<00:00, 5068.49it/s]                                                                       
Evaluating Text-Based Last Similar Recommendations:
------------------------------
{'recall@5': 0.05212683681361176, 'ndcg@5': 0.026660292010049123, 'mrr': 0.0182822033170061}
------------------------------
Per-user metrics saved to /home/kacharya33/nanoGenRec/peruser_metrics/LIS/bm25/toys.jsonl

--- Evaluation Summary ---
Dataset: toys
BM25 index file: /home/kacharya33/nanoGenRec/bm25_indexes/toys_index
Metrics: {'recall@5': 0.05212683681361176, 'ndcg@5': 0.026660292010049123, 'mrr': 0.0182822033170061}
Running job for dataset: sports, data family: amazon, k: 5, split: test, bm25_index_name: sports_index
WARNING:2025-05-22 12:59:12,984:jax._src.xla_bridge:967: An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
Split strings:   0%|          | 0/18267 [00:00<?, ?it/s]                                                        Loaded BM25 retriever from /home/kacharya33/nanoGenRec/bm25_indexes/sports_index

Qrels (test):
------------------------------
Split strings:   0%|          | 0/35597 [00:00<?, ?it/s]Split strings:  66%|██████▋   | 23649/35597 [00:00<00:00, 236473.88it/s]                                                                        BM25S Retrieve:   0%|          | 0/35597 [00:00<?, ?it/s]BM25S Retrieve:   1%|▏         | 481/35597 [00:00<00:07, 4803.00it/s]BM25S Retrieve:   3%|▎         | 1010/35597 [00:00<00:06, 5084.57it/s]BM25S Retrieve:   4%|▍         | 1554/35597 [00:00<00:06, 5246.32it/s]BM25S Retrieve:   6%|▌         | 2079/35597 [00:00<00:09, 3389.07it/s]BM25S Retrieve:   7%|▋         | 2620/35597 [00:00<00:08, 3926.79it/s]BM25S Retrieve:   9%|▉         | 3160/35597 [00:00<00:07, 4332.07it/s]BM25S Retrieve:  10%|█         | 3709/35597 [00:00<00:06, 4657.52it/s]BM25S Retrieve:  12%|█▏        | 4253/35597 [00:00<00:06, 4880.82it/s]BM25S Retrieve:  13%|█▎        | 4801/35597 [00:01<00:06, 5054.33it/s]BM25S Retrieve:  15%|█▌        | 5341/35597 [00:01<00:05, 5155.33it/s]BM25S Retrieve:  17%|█▋        | 5885/35597 [00:01<00:05, 5237.83it/s]BM25S Retrieve:  18%|█▊        | 6429/35597 [00:01<00:05, 5296.89it/s]BM25S Retrieve:  20%|█▉        | 6967/35597 [00:01<00:05, 5313.36it/s]BM25S Retrieve:  21%|██        | 7504/35597 [00:01<00:05, 5329.84it/s]BM25S Retrieve:  23%|██▎       | 8041/35597 [00:01<00:05, 5334.56it/s]BM25S Retrieve:  24%|██▍       | 8578/35597 [00:01<00:05, 5333.39it/s]BM25S Retrieve:  26%|██▌       | 9115/35597 [00:01<00:04, 5342.92it/s]BM25S Retrieve:  27%|██▋       | 9652/35597 [00:01<00:04, 5350.18it/s]BM25S Retrieve:  29%|██▊       | 10188/35597 [00:02<00:04, 5345.98it/s]BM25S Retrieve:  30%|███       | 10724/35597 [00:02<00:04, 5349.10it/s]BM25S Retrieve:  32%|███▏      | 11260/35597 [00:02<00:04, 5333.52it/s]BM25S Retrieve:  33%|███▎      | 11794/35597 [00:02<00:04, 5318.75it/s]BM25S Retrieve:  35%|███▍      | 12332/35597 [00:02<00:04, 5335.76it/s]BM25S Retrieve:  36%|███▌      | 12869/35597 [00:02<00:04, 5345.93it/s]BM25S Retrieve:  38%|███▊      | 13406/35597 [00:02<00:04, 5350.63it/s]BM25S Retrieve:  39%|███▉      | 13942/35597 [00:02<00:04, 5352.16it/s]BM25S Retrieve:  41%|████      | 14479/35597 [00:02<00:03, 5355.36it/s]BM25S Retrieve:  42%|████▏     | 15015/35597 [00:02<00:03, 5329.35it/s]BM25S Retrieve:  44%|████▎     | 15550/35597 [00:03<00:03, 5331.99it/s]BM25S Retrieve:  45%|████▌     | 16084/35597 [00:03<00:03, 5326.82it/s]BM25S Retrieve:  47%|████▋     | 16619/35597 [00:03<00:03, 5331.90it/s]BM25S Retrieve:  48%|████▊     | 17157/35597 [00:03<00:03, 5345.01it/s]BM25S Retrieve:  50%|████▉     | 17692/35597 [00:03<00:03, 5327.51it/s]BM25S Retrieve:  51%|█████     | 18231/35597 [00:03<00:03, 5343.11it/s]BM25S Retrieve:  53%|█████▎    | 18766/35597 [00:03<00:03, 5337.49it/s]BM25S Retrieve:  54%|█████▍    | 19303/35597 [00:03<00:03, 5344.35it/s]BM25S Retrieve:  56%|█████▌    | 19838/35597 [00:03<00:02, 5315.13it/s]BM25S Retrieve:  57%|█████▋    | 20371/35597 [00:03<00:02, 5316.58it/s]BM25S Retrieve:  59%|█████▊    | 20903/35597 [00:04<00:02, 5313.51it/s]BM25S Retrieve:  60%|██████    | 21435/35597 [00:04<00:02, 5304.12it/s]BM25S Retrieve:  62%|██████▏   | 21969/35597 [00:04<00:02, 5313.56it/s]BM25S Retrieve:  63%|██████▎   | 22503/35597 [00:04<00:02, 5318.95it/s]BM25S Retrieve:  65%|██████▍   | 23042/35597 [00:04<00:02, 5338.88it/s]BM25S Retrieve:  66%|██████▌   | 23576/35597 [00:04<00:03, 3503.15it/s]BM25S Retrieve:  68%|██████▊   | 24115/35597 [00:04<00:02, 3915.74it/s]BM25S Retrieve:  69%|██████▉   | 24650/35597 [00:04<00:02, 4257.06it/s]BM25S Retrieve:  71%|███████   | 25182/35597 [00:05<00:02, 4526.75it/s]BM25S Retrieve:  72%|███████▏  | 25716/35597 [00:05<00:02, 4742.69it/s]BM25S Retrieve:  74%|███████▎  | 26251/35597 [00:05<00:01, 4909.27it/s]BM25S Retrieve:  75%|███████▌  | 26785/35597 [00:05<00:01, 5030.83it/s]BM25S Retrieve:  77%|███████▋  | 27321/35597 [00:05<00:01, 5125.34it/s]BM25S Retrieve:  78%|███████▊  | 27859/35597 [00:05<00:01, 5196.83it/s]BM25S Retrieve:  80%|███████▉  | 28389/35597 [00:05<00:01, 5220.88it/s]BM25S Retrieve:  81%|████████▏ | 28924/35597 [00:05<00:01, 5257.89it/s]BM25S Retrieve:  83%|████████▎ | 29455/35597 [00:05<00:01, 5269.34it/s]BM25S Retrieve:  84%|████████▍ | 29996/35597 [00:05<00:01, 5310.54it/s]BM25S Retrieve:  86%|████████▌ | 30530/35597 [00:06<00:00, 5316.37it/s]BM25S Retrieve:  87%|████████▋ | 31066/35597 [00:06<00:00, 5328.40it/s]BM25S Retrieve:  89%|████████▉ | 31601/35597 [00:06<00:00, 5316.53it/s]BM25S Retrieve:  90%|█████████ | 32140/35597 [00:06<00:00, 5336.32it/s]BM25S Retrieve:  92%|█████████▏| 32675/35597 [00:06<00:00, 5339.99it/s]BM25S Retrieve:  93%|█████████▎| 33210/35597 [00:06<00:00, 5325.93it/s]BM25S Retrieve:  95%|█████████▍| 33743/35597 [00:06<00:00, 5322.61it/s]BM25S Retrieve:  96%|█████████▋| 34276/35597 [00:06<00:00, 5308.91it/s]BM25S Retrieve:  98%|█████████▊| 34811/35597 [00:06<00:00, 5318.76it/s]BM25S Retrieve:  99%|█████████▉| 35347/35597 [00:06<00:00, 5330.04it/s]                                                                       
Evaluating Text-Based Last Similar Recommendations:
------------------------------
{'recall@5': 0.021153467988875466, 'ndcg@5': 0.011012792672956575, 'mrr': 0.007661226133288385}
------------------------------
Per-user metrics saved to /home/kacharya33/nanoGenRec/peruser_metrics/LIS/bm25/sports.jsonl

--- Evaluation Summary ---
Dataset: sports
BM25 index file: /home/kacharya33/nanoGenRec/bm25_indexes/sports_index
Metrics: {'recall@5': 0.021153467988875466, 'ndcg@5': 0.011012792672956575, 'mrr': 0.007661226133288385}
